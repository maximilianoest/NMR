function [rotatedX,rotatedY,rotatedZ] = ...
    rotateTrajectoriesWithRotationMatrix(rotationMatrix,X,Y,Z)

rotatedX = (rotationMatrix(1,1)*X ...
    +rotationMatrix(1,2)* Y ...
    +rotationMatrix(1,3)*Z );
rotatedY = (rotationMatrix(2,1)*X ...
    +rotationMatrix(2,2)* Y ...
    +rotationMatrix(2,3)*Z );
rotatedZ = (rotationMatrix(3,1)*X ...
    +rotationMatrix(3,2)* Y ...
    +rotationMatrix(3,3)*Z );

end
